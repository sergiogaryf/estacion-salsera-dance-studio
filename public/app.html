<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Mi App - Estacion Salsera</title>
  <meta name="description" content="Panel del alumno - Estacion Salsera, El Tren del Sabor">

  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#0a0a0a">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Estacion Salsera">

  <!-- Manifest & Icons -->
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="img/icons/icon-192x192.png">
  <link rel="icon" type="image/svg+xml" href="img/favicon.svg">

  <!-- Styles -->
  <link rel="stylesheet" href="css/shared.css">
  <link rel="stylesheet" href="css/app.css">

</head>
<body class="app-page">

  <!-- Loading Overlay -->
  <div id="appLoading" class="loading-overlay">
    <div class="spinner"></div>
    <p class="text-muted" style="font-size: 0.85rem;">Cargando tu informacion...</p>
  </div>

  <!-- ============================================ -->
  <!-- MAIN CONTENT -->
  <!-- ============================================ -->
  <main id="appContent" class="app-content hidden">

    <!-- ====== TAB: INICIO ====== -->
    <section id="tab-inicio" class="tab-section active">
      <!-- Header -->
      <div class="app-header">
        <div class="app-header-brand">
          <img src="img/Logo.png" alt="Estacion Salsera" class="app-logo">
          <span class="app-brand-text">Estacion Salsera</span>
        </div>
      </div>

      <!-- Greeting -->
      <h1 class="greeting">Hola, <span id="userName">...</span>!</h1>

      <!-- Clases restantes -->
      <div class="glass-card card-clases">
        <div class="card-label">Te quedan</div>
        <div class="card-big-number"><span id="clasesRestantes">0</span> clases</div>
        <div class="progress-bar-track">
          <div class="progress-bar-fill" id="clasesProgress" style="width: 0%"></div>
        </div>
        <div class="progress-bar-info">
          <span id="clasesAsistidasInfo">0</span> asistidas de <span id="clasesContratadasInfo">0</span>
        </div>
      </div>

      <!-- Proxima clase -->
      <div class="glass-card card-proxima">
        <div class="card-label">Proxima clase</div>
        <div id="proximaClaseContent">
          <p class="text-muted" style="font-size: 0.9rem;">Calculando...</p>
        </div>
      </div>

      <!-- Tu sede -->
      <div class="glass-card card-sede">
        <div class="card-label">Tu sede</div>
        <div class="card-sede-name" id="userSede">-</div>
      </div>

      <!-- Eventos inline -->
      <div id="eventosInicio" class="eventos-inicio"></div>
    </section>

    <!-- ====== TAB: HORARIO ====== -->
    <section id="tab-horario" class="tab-section">
      <h2 class="section-title">Mi Horario</h2>
      <div id="horarioList" class="horario-list">
        <div class="empty-state">
          <span class="empty-icon">&#128336;</span>
          <p>Cargando horario...</p>
        </div>
      </div>
    </section>

    <!-- ====== TAB: CALENDARIO ====== -->
    <section id="tab-calendario" class="tab-section">
      <h2 class="section-title">Calendario Marzo 2026</h2>
      <p class="cal-reminder-app">Recuerda llegar 10 minutos antes a clases.</p>
      <div class="cal-app-wrapper glass-card">
        <div class="cal-header-dias-app">
          <span>Lun</span><span>Mar</span><span>Mie</span><span>Jue</span><span>Vie</span><span>Sab</span><span>Dom</span>
        </div>
        <div class="cal-grid-app" id="calGridApp"></div>
      </div>
      <div class="cal-legend-app">
        <span class="cal-legend-item-app"><span class="cal-dot-app cal-dot-bachata-bas"></span> Bachata Bas</span>
        <span class="cal-legend-item-app"><span class="cal-dot-app cal-dot-casino-bas"></span> Casino Bas</span>
        <span class="cal-legend-item-app"><span class="cal-dot-app cal-dot-bachata-int"></span> Bachata Int</span>
        <span class="cal-legend-item-app"><span class="cal-dot-app cal-dot-casino-int"></span> Casino Int</span>
        <span class="cal-legend-item-app"><span class="cal-dot-app cal-dot-mambo"></span> Mambo</span>
      </div>
      <a href="marzo_clases_2026.ics" download class="btn-secondary btn-download-ics">Descargar calendario (.ics)</a>
    </section>

    <!-- ====== TAB: EVALUACION ====== -->
    <section id="tab-evaluacion" class="tab-section">
      <h2 class="section-title">Evaluacion del dia</h2>

      <div class="glass-card eval-app-form">
        <!-- Selector de curso -->
        <div class="form-group">
          <label class="eval-app-label">Tu curso</label>
          <select id="evalAppCurso" class="form-input">
            <option value="">Selecciona tu curso</option>
          </select>
        </div>

        <!-- Numero de clase -->
        <div class="form-group">
          <label class="eval-app-label">Numero de clase</label>
          <div class="eval-app-clase-btns">
            <button type="button" class="eval-app-clase-btn" data-clase="1">1</button>
            <button type="button" class="eval-app-clase-btn" data-clase="2">2</button>
            <button type="button" class="eval-app-clase-btn" data-clase="3">3</button>
            <button type="button" class="eval-app-clase-btn" data-clase="4">4</button>
          </div>
        </div>

        <!-- Sliders -->
        <div class="eval-app-slider-group">
          <div class="eval-app-slider-label">
            <span>Disfrute</span>
            <span class="eval-app-slider-val" id="evalAppDisfruteVal">5</span>
          </div>
          <input type="range" id="evalAppDisfrute" min="1" max="10" value="5">
        </div>

        <div class="eval-app-slider-group">
          <div class="eval-app-slider-label">
            <span>Comprension</span>
            <span class="eval-app-slider-val" id="evalAppComprensionVal">5</span>
          </div>
          <input type="range" id="evalAppComprension" min="1" max="10" value="5">
        </div>

        <div class="eval-app-slider-group">
          <div class="eval-app-slider-label">
            <span>Comodidad en pareja</span>
            <span class="eval-app-slider-val" id="evalAppComodidadVal">5</span>
          </div>
          <input type="range" id="evalAppComodidad" min="1" max="10" value="5">
        </div>

        <div class="eval-app-slider-group">
          <div class="eval-app-slider-label">
            <span>Confianza</span>
            <span class="eval-app-slider-val" id="evalAppConfianzaVal">5</span>
          </div>
          <input type="range" id="evalAppConfianza" min="1" max="10" value="5">
        </div>

        <!-- Binaria -->
        <div class="form-group">
          <label class="eval-app-label">Bailaste con alguien nuevo?</label>
          <div class="eval-app-binaria">
            <button type="button" class="eval-app-binaria-btn" id="evalAppBaileSi">Si</button>
            <button type="button" class="eval-app-binaria-btn" id="evalAppBaileNo">No</button>
          </div>
        </div>

        <!-- Comentario -->
        <div class="form-group">
          <label class="eval-app-label">Comentario (opcional)</label>
          <textarea id="evalAppComentario" class="form-input eval-app-textarea" placeholder="Como te sentiste hoy?" rows="3"></textarea>
        </div>

        <!-- Mensajes -->
        <div id="evalAppError" class="eval-app-msg eval-app-msg-error hidden"></div>
        <div id="evalAppExito" class="eval-app-msg eval-app-msg-success hidden"></div>

        <!-- Boton enviar -->
        <button type="button" id="btnEnviarEvalApp" class="btn-primary eval-app-submit">Enviar mi evaluacion</button>
      </div>
    </section>

    <!-- ====== TAB: COMPANEROS ====== -->
    <section id="tab-companeros" class="tab-section">
      <h2 class="section-title">Companeros</h2>
      <div id="companerosList" class="companeros-list">
        <div class="empty-state">
          <span class="empty-icon">&#128101;</span>
          <p>Cargando companeros...</p>
        </div>
      </div>
    </section>

    <!-- ====== TAB: PERFIL ====== -->
    <section id="tab-perfil" class="tab-section">
      <div class="perfil-header">
        <div class="perfil-avatar-wrap">
          <div class="avatar avatar-xl" id="perfilAvatar">--</div>
          <img id="perfilFotoImg" class="avatar avatar-xl perfil-foto-img" src="" alt="Foto de perfil" style="display:none">
          <label for="fotoInput" class="perfil-foto-btn" title="Cambiar foto">&#128247;</label>
          <input type="file" id="fotoInput" accept="image/*" style="display:none">
        </div>
        <h2 class="perfil-name" id="perfilName">-</h2>
        <span class="badge badge-gold" id="perfilRole">alumno</span>
      </div>

      <div class="perfil-info-grid">
        <div class="glass-card perfil-info-card">
          <div class="perfil-info-label">Email</div>
          <div class="perfil-info-value" id="perfilEmail">-</div>
        </div>
        <div class="glass-card perfil-info-card">
          <div class="perfil-info-label">Telefono</div>
          <div class="perfil-info-value" id="perfilTelefono">-</div>
        </div>
        <div class="glass-card perfil-info-card">
          <div class="perfil-info-label">Sede</div>
          <div class="perfil-info-value" id="perfilSede">-</div>
        </div>
        <div class="glass-card perfil-info-card">
          <div class="perfil-info-label">Nivel</div>
          <div class="perfil-info-value" id="perfilNivel">-</div>
        </div>
      </div>

      <div class="perfil-stats">
        <div class="glass-card stat-card">
          <div class="stat-number" id="statContratadas">0</div>
          <div class="stat-label">Contratadas</div>
        </div>
        <div class="glass-card stat-card">
          <div class="stat-number" id="statAsistidas">0</div>
          <div class="stat-label">Asistidas</div>
        </div>
        <div class="glass-card stat-card">
          <div class="stat-number" id="statPorcentaje">0%</div>
          <div class="stat-label">Asistencia</div>
        </div>
      </div>

      <button id="logoutBtn" class="btn-secondary logout-btn">Cerrar Sesion</button>
    </section>

  </main>

  <!-- ============================================ -->
  <!-- BOTTOM TAB BAR (6 tabs) -->
  <!-- ============================================ -->
  <nav id="tabBar" class="tab-bar hidden">
    <button class="tab-item active" data-tab="tab-inicio">
      <span class="tab-icon">&#8962;</span>
      <span class="tab-label">Inicio</span>
    </button>
    <button class="tab-item" data-tab="tab-horario">
      <span class="tab-icon">&#128336;</span>
      <span class="tab-label">Horario</span>
    </button>
    <button class="tab-item" data-tab="tab-calendario">
      <span class="tab-icon">&#128197;</span>
      <span class="tab-label">Calendario</span>
    </button>
    <button class="tab-item" data-tab="tab-evaluacion">
      <span class="tab-icon">&#9998;</span>
      <span class="tab-label">Evaluacion</span>
    </button>
    <button class="tab-item" data-tab="tab-companeros">
      <span class="tab-icon">&#128101;</span>
      <span class="tab-label">Companeros</span>
    </button>
    <button class="tab-item" data-tab="tab-perfil">
      <span class="tab-icon">&#9787;</span>
      <span class="tab-label">Perfil</span>
    </button>
  </nav>

  <!-- Toast -->
  <div id="toastContainer" class="toast-container"></div>

  <!-- Scripts -->
  <script src="js/api-service.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
